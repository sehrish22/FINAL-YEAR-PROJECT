extends ../layout

block content
  link(rel='stylesheet', href='/stylesheets/details.css')

  .container.product-details
    .content-box
      // Left Side - Image
      .image-container
        if product.image
          img(src=product.image, alt=product.name, class="product-img")

      // Right Side - Product Details
      .details-container
        h1.product-title= product.name
        p.product-info üè∑Ô∏è Type: #{product.type}
        p.product-info üí∞ Price: Rs.#{product.price}
        p.product-info üìå Description: #{product.description}
        p.product-info üì¶ In Stock:
          if product.instock > 0
            span.in-stock ‚úÖ #{product.instock} available
          else
            span.out-stock ‚ùå Out of Stock

        .btn-group.action-buttons
          a.btn.btn-cart(href="/products/cart/" + product._id) üõí Add to Cart
          if user && user.role =="seller"
            a.btn.btn-edit(href="/products/edit/" + product._id) ‚úèÔ∏è Edit
            a.btn.btn-delete(href="/products/delete/" + product._id) üóë Delete
    hr

  h2.reviews-title Reviews
  if reviews && reviews.length
    .reviews-container
      each review in reviews
        .review-card
          .review-header
            .review-rating
              span.rating-stars= '‚≠ê'.repeat(review.rating)
            .review-user
              if review.user
                p Posted by #{review.user.name} on #{review.createdAt.toDateString()}
              else
                p Posted by Anonymous on #{review.createdAt.toDateString()}
          .review-comment
            p= review.comment
  else
    p.no-reviews No reviews yet. Be the first to review this product!

  hr

  h2 Add a Review
  if user && user.role === 'buyer'
    form(action=`/products/${product._id}/review`, method="POST")
      label(for="rating") Rating:
      select(name="rating", id="rating", required)
        option(value="") Select rating
        option(value="1") 1 ‚≠ê
        option(value="2") 2 ‚≠ê
        option(value="3") 3 ‚≠ê
        option(value="4") 4 ‚≠ê
        option(value="5") 5 ‚≠ê

      label(for="comment") Comment:
      textarea(name="comment", id="comment", required)

      button(type="submit") Submit Review
  else if !user
    p Please log in as a buyer to leave a review.
  else if user.role !== 'buyer'
    p Only buyers can leave a review for this product.
